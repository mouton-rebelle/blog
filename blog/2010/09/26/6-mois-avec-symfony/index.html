
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>6 mois avec Symfony - #fixme</title>
  <meta name="author" content="Cédric Fontaine">

  
  <meta name="description" content="Les frameworks PHP ne manquent pas ; Symfony est l&#8217;un d&#8217;entre eux, et
probablement pas le moins populaire. Anciennement habitué de Zend &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mouton-rebelle.github.com/blog/blog/2010/09/26/6-mois-avec-symfony">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/blog/atom.xml" rel="alternate" title="#fixme" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">#fixme</a></h1>
  
    <h2>du webdev mais pas que</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mouton-rebelle.github.com/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">6 mois avec Symfony</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-26T18:28:00+02:00" pubdate data-updated="true">26/09/2010</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Les frameworks PHP ne manquent pas ; Symfony est l&#8217;un d&#8217;entre eux, et
probablement pas le moins populaire. Anciennement habitué de Zend Framework,
j&#8217;ai récemment utilisé Symfony sur deux projets. Debriefing.</p>

<!-- more -->


<h3>De quoi qu&#8217;on parle</h3>

<p>Bonne question, merci, c&#8217;est toujours mieux de préciser le cadre. Si on prend
la définition de Wikipedia, qui pour le coup me plait bien, «En programmation
informatique, un framework est un kit de composants logiciels structurels, qui
définissent les fondations ainsi que les grandes lignes de l&#8217;organisation de
tout ou partie d&#8217;un logiciel». C&#8217;est tout à fait ça, des briques, du ciments,
et quelques pistes sur comment utiliser le tout.</p>

<p>Pendant quelques années, j&#8217;ai préféré utiliser un framework &#8220;maison&#8221;, en
arguant de la parfaite adaptation à mes besoins, et d&#8217;une plus grande facilité
à identifier les bugs. Je suis convaincu désormais que c&#8217;était une erreur, au
moins pour deux raisons :</p>

<ul>
<li>Une communauté active sera toujours plus efficace et talentueuse pour résoudre des problèmes qu&#8217;un gars ou qu&#8217;une petite équipe dans leur coin. De plus la plupart des frameworks sont open source, et rien n&#8217;empêche de mettre les mains dans le cambouis pour faire avancer un projet dans une direction qui nous intéresse, pour combler une lacune qui nous semble cruciale, etc&#8230;</li>
<li>Un projet développé sur un framework communautaire sera plus simple à maintenir ; si vous l&#8217;abandonnez pendant un temps, vous avez de bonnes chances pour que les briques du framework aient suivi les évolutions techno ; si un nouveau développeur doit intervenir dessus, il sera peut être déjà au courant des bases, de la logique, de l&#8217;architecture. Et dans tous les cas il pourra se former beaucoup plus facilement qu&#8217;avec un framework maison à la documentation aléatoire.</li>
</ul>


<p>Donc, un framework c&#8217;est un ensemble de briques et de principes et c&#8217;est
essentiel pour tout développement d&#8217;une certaine envergure.</p>

<h3>La philosophie Symfony</h3>

<p>Là où certains framework (ZF par exemple) se contentent de vous offrir des
briques, vous laissant libre de les utiliser ou non et la façon dont vous
voulez les structurez, Symfony impose sa vision des choses et son arborescence
de projet. Ouvertement inspiré de Rails, il repose largement sur des fichiers
de configurations (au format YAML) et sur des générateurs de code.</p>

<p>Concrètement, une fois le framework installé, vous disposez d&#8217;un outil CLI
pour effectuer toutes les tâches répétitives classiques. Pour un nouveau
projet, vous allez donc procéder ainsi :</p>

<ol>
<li>Paramétrage de la connexion base de données dans le fichier database.yml</li>
<li>Création de la structure des données dans le fichier schema.yml (Symfony utilise l&#8217;ORM Doctrine, je reviendrais dessus plus tard)</li>
<li>Génération de la base de données et des classes PHP en CLI. Vous avez désormais des classes vous permettant de manipuler vos données, du basique : $monObjet->save(), $monObjet->getNom(), etc&#8230; au nettement plus évolué avec les classes de Formulaire, permettant à Symfony de vous posez un formulaire avec validation des données en 2 lignes de code. Toutes ces classes générées sont bien sûr conçues pour être étendues.</li>
<li>Vous allez ensuite probablement générer un contrôleur / une vue (pattern MVC), et commencer à bidouiller le fichier de configuration des routes&#8230;</li>
</ol>


<p>Pas besoin d&#8217;être un pro de Symfony pour voir l&#8217;intérêt d&#8217;un tel système ;
déjà, vous écrivez beaucoup moins de code. Ensuite, si vous devez changer la
structure des données (ce qui arrive toujours), vous avez juste à modifier le
fichier de configuration qui décrit vos données, et Symfony ré-génère pour
vous la base de données, les modèles et les formulaires.</p>

<h3>Doctrine, l&#8217;abstraction des données</h3>

<p>Je sais pas vous, mais moi on m&#8217;a toujours dit qu&#8217;il fallait bien séparer les
données. D&#8217;abord, être indépendant d&#8217;un système de BDD, pour pouvoir passer de
Mysql à Oracle en calquant des doigts (le truc qui n&#8217;arrive de toutes façons
jamais&#8230;). Et ensuite pour séparer la partie &#8220;stockage&#8221; de la partie
&#8220;logique&#8221; (data / buisness si je dis pas de conneries). L&#8217;étape suivante,
c&#8217;est l&#8217;ORM, qui gère tout ça, avec les notions de relations entre les objets
(un livre a un ou plusieurs auteur, un auteur a écrit un ou plusieurs livre).
Au départ, Symfony utilisait Propel, mais depuis quelques années c&#8217;est
Doctrine qui prend le pas&#8230;. Doctrine est une solution open source qu&#8217;on peut
très bien utiliser indépendamment de Symfony. En revanche, l&#8217;inverse n&#8217;est pas
vrai ; Syfmony a tellement de fonctionnalités qui reposent sur Doctrine que
faire l&#8217;impasse dessus enleverait pratiquement tout son intérêt au framework.</p>

<p>Doctrine donc, est l&#8217;ORM que Symfony utilise pour générer votre BDD et toutes
vos classes à partir d&#8217;un bête fichier qui décrit votre schéma de données. Et
pour cette partie, il fait un super travail. (Si je reprends mon exemple des
livres et des auteurs, il vous rapatriera les livres sur l&#8217;objet auteur, et
inversement ; le formulaire de saisie d&#8217;un livre vous proposera de choisir les
auteurs, etc&#8230;).</p>

<p>Où j&#8217;ai beaucoup plus de mal à apprécier Doctrine, c&#8217;est pour la partie
interrogation des données. En effet, Doctrine impose sa vision des requêtes
sql, avec des méthodes maison qu&#8217;on peut chainer à volonté :</p>

<p><code>$q = Doctrine_Core::getTable('Element')-&gt;createQuery(); $q-&gt;addWhere('active
= ? ',true) -&gt;orderBy('ordre DESC');</code></p>

<p>Si ça convient très bien pour des requêtes simples comme l&#8217;exemple ci-dessus,
c&#8217;est catastrophique dès qu&#8217;on a des jointures un peu complexe, ou que l&#8217;on
veut faire des GROUP BY, obtenir un COUNT, etc&#8230; La syntaxe est lourde, ne
permet pas de tout faire, et produit des requêtes aux performances souvent
catastrophiques. Ma solution pour l&#8217;instant : me passer de Doctrine dans ces
cas limites, et faire du PDO classique. Car heureusement Doctrine nous laisse
récupérer la connexion :</p>

<p><code>$conn = Doctrine_Manager::connection();</code></p>

<h3>Admin Generator</h3>

<p>Cette fonctionnalité est la plus montrée / vantée, car la plus simple à mettre
en avant ; Symfony permet en quelques minutes de générer une interface
d&#8217;administration complète, offrant toutes les fonctions CRUD. En quelques
secondes, vous avez une interface complète avec la liste des enregistrements
de la base, et des liens pour les supprimer, les modifier, et en créer de
nouveau. Et même un outil pour filtrer / faire une recherche. Le tout, comme
toujours dans Symfony, est modifiable via les fichiers de configurations Yaml,
et sur-chargeable via un système de classe bien conçu.</p>

<p>J&#8217;étais sceptique, mais cet outil répond bien à 75% des cas en l&#8217;état, et
permet de gérer pratiquement tous les 25% restant via un peu de code bien
placé.</p>

<h3>Routing et autres fonctions clés de Symfony</h3>

<p>Je termine sur les bons côtés de Symfony par un petit paragraphe en vrac ; le
routing (mapper une url à une méthode d&#8217;un contrôleur) est très bien vu dans
ce framework. Plus verbeux que dans ZF, il repose essentiellement sur le
fichier de configuration routes.yml de l&#8217;application. Où c&#8217;est assez fun c&#8217;est
qu&#8217;on peut réellement faire ce qu&#8217;on veut, pour chaque route, il n&#8217;y a pas
besoin d&#8217;adopter un système unique pour l&#8217;application. Faire la même chose
avec un autre outil serait certainement possible, mais beaucoup plus lourd.</p>

<p>Les autres joyeusetés ? En vrac, un système de tests complet, avec génération
automatique d&#8217;une base de test ; la facilité à insérer des fixtures dans une
base de dev ou de test ; les commandes pour déployer / synchroniser un projet
; des univers distincts et fonctionnels dès le départ (dev, test et prod); un
système de vues, de partials et de componnents simple à assimiler et vraiment
puissant ; des plugins qui s&#8217;installent en ligne de commandes&#8230; et j&#8217;oublie
sûrement beaucoup de choses&#8230;</p>

<h3>Défauts, comparaison à ZF et bilan</h3>

<p>Le plus gros défaut de Symfony, c&#8217;est sa documentation&#8230; Le meilleur document
de référence reste le tutorial Jobeet, qui couvre l&#8217;intégralité des fonctions
du framework sur un cas concret. Très intéressant pour démarrer, cette
solution devient catastrophique quand on cherche rapidement la description
d&#8217;une fonctionnalité, les paramètres d&#8217;une méthodes, etc&#8230; Les recherches sur
google sont frustrantes au possible, car on tombe le plus souvent sur des
pages &#8220;périmées&#8221; qui traitent de Symfony 1.0 ou 1.2&#8230;</p>

<p>Le Zend Framework Manual est un petit bijoux d&#8217;exhaustivité et de clarté en
comparaison, et c&#8217;est probablement normal les deux communautés n&#8217;étant pas
vraiment de taille comparable&#8230;</p>

<p>L&#8217;autre point noir a été reconnu et est en passe d&#8217;être résolu, avec la
version 2.0 qui devrait sortir mi-2011 ; « Too much magic », trop
d&#8217;automatismes, et du code au final assez crade et lourd. Il est impossible de
faire un var_dump sur un objet Symfony, l&#8217;objet est trop volumineux&#8230; Les
variables passées aux vues sont des globales, et nom des params d&#8217;un objets
vue. Dans le même registre, Symfony permet de générer de l&#8217;Ajax ; je vous
encourage vivement à coder ce genre de choses à la main, c&#8217;est guère plus
complexe, beaucoup plus propre / optimisé, et si vous vouliez faire du web
sans avoir l&#8217;impression de faire du web vus auriez de toutes façons choisis
des technos microsoft.</p>

<p>Symfony et Zend Framework s&#8217;opposent diamétralement au niveau de la
philosophie ; ZF vous donne une boite à outils, sans réel mode d&#8217;emploi,
tandis que Symfony vous impose une manière de travailler, de structurer votre
code. La courbe d&#8217;apprentissage est plus grande, et on a parfois l&#8217;impression
de ne pas tout maitriser&#8230; Mais au final ces quelques mois m&#8217;ont laissé une
bonne impression, et je reviendrais je pense régulièrement vers Symfony. Si
seulement la version 2 pouvait également résoudre le souci de la
documentation&#8230;</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Cédric Fontaine</span></span>

      








  


<time datetime="2010-09-26T18:28:00+02:00" pubdate data-updated="true">26/09/2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/blog/categories/php/'>php</a>, <a class='category' href='/blog/blog/categories/symfony/'>symfony</a>, <a class='category' href='/blog/blog/categories/webdev/'>webdev</a>, <a class='category' href='/blog/blog/categories/zf/'>zf</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://mouton-rebelle.github.com/blog/blog/2010/09/26/6-mois-avec-symfony/" data-via="moutonrebelle" data-counturl="http://mouton-rebelle.github.com/blog/blog/2010/09/26/6-mois-avec-symfony/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/blog/2010/06/15/entre-les-deux-mon-coeur-balance/" title="Previous Post: Entre les deux mon coeur balance">&laquo; Entre les deux mon coeur balance</a>
      
      
        <a class="basic-alignment right" href="/blog/blog/2010/11/04/dire-oui-aux-css-compilees/" title="next Post: Dire oui aux CSS compilées">Dire oui aux CSS compilées &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/blog/2011/11/23/le-coeur-des-pommes-2/">le coeur des pommes 2</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2011/11/14/le-coeur-des-pommes/">Le coeur des pommes</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2011/10/04/vous-allez-en-bouffer/">Vous allez en bouffer, des pommes !</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2011/09/15/about-flash/">About Flash</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2011/08/24/flattr/">Flattr, la licence globale à portée de clic...</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("moutonrebelle", 6, false);
    });
  </script>
  <script src="/blog/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/moutonrebelle" class="twitter-follow-button" data-show-count="false">Follow @moutonrebelle</a>
  
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/mouton.rebelle@gmail.com?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Cédric Fontaine -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'fixme';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mouton-rebelle.github.com/blog/blog/2010/09/26/6-mois-avec-symfony/';
        var disqus_url = 'http://mouton-rebelle.github.com/blog/blog/2010/09/26/6-mois-avec-symfony/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
